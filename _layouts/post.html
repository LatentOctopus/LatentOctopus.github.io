---
layout: default
---
<link rel="stylesheet" href="/assets/css/post_styles.css">

{%- include init.html -%}

{% assign content = page.content %}
{% assign spirit_tag = page.tags[0] %}
{% assign spirit_name = site.data.abbreviations[spirit_tag].name %}
{% assign spirit_effects = site.data.abbreviations[spirit_tag].effects %}

{% capture raw_filepaths %}
    {% for file in site.static_files %}
        {% assign path = file.path %}
        {{path}};
    {% endfor %}
{% endcapture %}
{% assign filepaths = raw_filepaths | split:';' | sort %}

<!-- Replace [[...]] in content  -->
{% assign contentarray = content | split:'[[' %}
{% for item in contentarray %}
    {% if forloop.index > 1 %}
        {% assign itemparts = item | split:']]' %}
        {% assign link = itemparts[0] %}
        {% if forloop.index == 2 %}
            {% assign links = link %}
        {% else %}
            {% assign links = links | append: '|' | append: link %}
        {% endif %}
        {% assign url = spirit_effects[link] %}
        >{{url}}<
        {% unless url %}
            {% for ext in ['.jpg', '.png'] %}
                {% assign fn = link | append: ext %}
                {% assign filepath = '/assets/images/' | append: fn %}
                {{filepath}}
                {% if filepaths contains filepath %}
                    {% assign url = fn %}
                    {% break %}
                {% endif %}
             {% endfor %}
        {% endif %}
        {% if forloop.index == 2 %}
            {% assign urls = url %}
        {% else %}
            {% assign urls = urls | append: '|' | append: url %}
        {% endif %}
    {% endif %}
{% endfor %}
{% assign urlarray = urls | split:'|' %}
{% assign linkarray = links | split:'|' %}
{% assign replacedcontent = page.content %}
{% for item in linkarray %}
    {% assign linktext = '<span class="spirit_effect_text">' | append: item | append: '<img class="spirit_effect_image" src="/assets/images/' | append: urlarray[forloop.index0] | append: '">' | append: '</span>' %}
    {% assign bracketlink = '[[' | append: item | append: ']]' %}
    {% assign replacedcontent = replacedcontent | replace: bracketlink,linktext %}
{% endfor %}
{% assign content = replacedcontent | markdownify %}

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">[{{spirit_name}}] {{ page.title | escape }}</h1>
    <p class="post-meta">
      {%- assign date_format = site.minima.date_format | default: "%b %-d, %Y" -%}
      <time class="dt-published" datetime="{{ page.date | date_to_xmlschema }}" itemprop="datePublished">
        {{ page.date | date: date_format }}
      </time>
      {%- if page.modified_date -%}
        ~ 
        {%- assign mdate = page.modified_date | date_to_xmlschema -%}
        <time class="dt-modified" datetime="{{ mdate }}" itemprop="dateModified">
          {{ mdate | date: date_format }}
        </time>
      {%- endif -%}
      {%- if page.author -%}
        â€¢ {% for author in page.author %}
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">{{ author }}</span></span>
            {%- if forloop.last == false %}, {% endif -%}
        {% endfor %}
      {%- endif -%}</p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    {{ content }}
  </div>
  
  <a class="u-url" href="{{ page.url | relative_url }}" hidden></a>
</article>
